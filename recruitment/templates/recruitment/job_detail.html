<!--
  Gabarit de détail d'une offre d'emploi.

  Ce gabarit affiche le titre, la description et les informations
  complémentaires (lieu, département) d'une offre. Il propose
  également un formulaire de candidature basé sur
  ``JobApplicationForm``. Le formulaire utilise ``multipart/form-data``
  pour permettre l'envoi d'un CV. Les champs du formulaire
  héritent des classes Tailwind définies dans le formulaire.
-->

{% extends "base.html" %}

{% block content %}
<section class="max-w-3xl mx-auto py-10">
  {#
    Ajout d’une icône « briefcase » avant le titre de l’offre pour
    renforcer l’identité visuelle.  L’icône se teinte grâce à
    text-brand et est alignée avec le titre.
  #}
  <h1 class="flex items-center gap-2 text-3xl font-bold mb-4">
    <svg class="w-6 h-6 text-brand" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <rect x="2" y="7" width="20" height="14" rx="2" ry="2" />
      <path d="M16 7V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v2" />
    </svg>
    {{ job.title }}
  </h1>
  {% if job.location or job.department %}
    <p class="mb-4 text-sm text-gray-600">
      {% if job.department %}<span class="font-medium">Département :</span> {{ job.department }}{% endif %}
      {% if job.department and job.location %} | {% endif %}
      {% if job.location %}<span class="font-medium">Lieu :</span> {{ job.location }}{% endif %}
    </p>
  {% endif %}
  <div class="prose max-w-none mb-8">
    {{ job.description|linebreaks }}
  </div>
  {#
    Icône d’envoi avant le sous-titre « Postuler à cette offre ».  Le
    dessin représente une plume/feuille symbolisant la candidature.
  #}
  <h2 class="flex items-center gap-2 text-2xl font-semibold mb-4">
    <svg class="w-5 h-5 text-brand" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M2 22l21-9L2 4v7l15 2-15 2z" />
    </svg>
    Postuler à cette offre
  </h2>
  <!--
    Le formulaire envoie désormais la candidature vers l'URL
    ``recruitment:job_apply`` qui traite la persistance.  Sans ``action``
    explicite, le navigateur renverrait la requête POST à la page de
    détails, provoquant un rechargement en boucle sans sauvegarde.
  -->
  <div class="fancy-form">
  <form method="post" action="{% url 'recruitment:job_apply' job.slug %}" enctype="multipart/form-data" class="space-y-4">
    {% csrf_token %}
    {{ form.non_field_errors }}
    <div>
      {{ form.name.label_tag }}<br />
      {{ form.name }}
      {{ form.name.errors }}
    </div>
    <div>
      {{ form.email.label_tag }}<br />
      {{ form.email }}
      {{ form.email.errors }}
    </div>
    <div>
      {{ form.phone.label_tag }}<br />
      {{ form.phone }}
      {{ form.phone.errors }}
    </div>
    <div>
      {{ form.message.label_tag }}<br />
      {{ form.message }}
      {{ form.message.errors }}
    </div>
    <div class="grid md:grid-cols-2 gap-4">
      <div>
        {{ form.resume.label_tag }}<br />
        {{ form.resume }}
        {{ form.resume.errors }}
      </div>
      <div>
        {{ form.cover_letter.label_tag }}<br />
        {{ form.cover_letter }}
        {{ form.cover_letter.errors }}
      </div>
    </div>
    <button type="submit" class="px-5 py-3 mt-2 rounded-xl text-white" style="background: var(--brand-primary);">
      Envoyer ma candidature
    </button>
  </form>
  </div>
</section>
{% endblock %}